备注：代码思路！=伪代码思路。代码思路绝大部分==伪代码，实现时有所更改。